title: 尝试各种大语言模型
date: 2023-05-15 14:40:57
category: Life
---

因为ChatGPT的出现带火了大语言模型，也引起我的强烈兴趣，现在项目也想在这个热点上靠，这2个月一直在运行各种大语言模型。

上周又试着运行了好几个模型，基本没有可用的，比较丧气。

想找的模型需要满足两个最基本要求：支持中文和CPU运行。

因为大语言模型非常吃资源，手头能用的机器根本满足不了，想运行体验是不可能的。所幸有llama.cpp这样的项目，让CPU运行成为可能。但这个项目需要特定格式的模型文件，所以需要了解各种模型的格式，以及如何转成指定格式ggml。这里依然还有不少困扰，到底是hf格式的，bert格式的，GPT-2格式的还是别的什么格式的。运行转换脚本也是各种问题，千奇百怪。

然后就是要支持中文。这个要求就能过滤掉一大堆现在的开源模型。我试了下基本可用的就只有ChatGLM，Chinese-LLaMA-Alpaca, 还有一个叫Linly的。另外通过调研好多开源的模型也支持中文，如dolly v2, redpajama, openllama, 可周末我试了一下，没一个成功的，要么格式无法转化成ggml, 要么输出的根本就是乱码，让人失望。之前企图让chatglm也转成ggml，结果才发现这个语言模型是靠近BERT类的，根本没法转换！

现在项目想搞个问答系统，正好前几天发现了宝藏般的privateGPT项目，这个项目简单易用，同时还能支持CPU推理运行，这能大大提高本机运行的机率。因为对模型内部结构和各种概念不熟悉，不知道怎么设定文本嵌入，后来才发现大语言模型可以同时当嵌入。运行试验了一下，Linly和Chinese-Alpaca都可以运行。可是Linly问题很多，首先就是输出有乱码，也不知道如何解决，还专门加了模型开发人的微信，但按他给的一些办法还是没有解决问题，似乎需要对模型做某种转换。其次是输出结果也不是很准确，似乎是因为这种问答系统实现的原理决定的。Chinese-LLaMA-Alpaca这个中文支持的非常完善，可是也有胡乱回答的问题，另外它的ggml需要自己手动生成，还好从hf上下载了别人量化好的模型。

今早发现Linly有新的版本出现了，但是还没有ggml量化版本，现在只能再等等。Chinese-Alpaca前不久也更新了，但也没有更新版本的ggml量化。让人着急。
